# Formal Specification: Automated Problem-Grading and Management Platform (Full-Stack React Version, Simplified Infrastructure)

## Table of Contents
1. [Overview](#overview)
2. [Core Features](#core-features)
3. [Authentication & User Management](#authentication--user-management)
4. [Classroom Management & Settings](#classroom-management--settings)
5. [Problem Classes & Problems](#problem-classes--problems)
6. [Problem Generation (LLM Integration)](#problem-generation-llm-integration)
7. [Submission, Grading, and Mastery](#submission-grading-and-mastery)
8. [Grading Infrastructure & Job Status](#grading-infrastructure--job-status)
9. [File Uploads & Security](#file-uploads--security)
10. [Logging](#logging)
11. [Additional Security & Compliance](#additional-security--compliance)
12. [Frontend Requirements](#frontend-requirements)
13. [Backend & Infrastructure](#backend--infrastructure)
14. [Extensibility & Future Considerations](#extensibility--future-considerations)

---

## 1. Overview

This document specifies a web application for classroom management, problem generation, automated grading, and mastery-based progression, scalable to single or multiple classes. The system is built as a full-stack React application (frontend and backend) using Vite as the build tool and JavaScript/TypeScript as the primary language. The database is Amazon RDS with MySQL. Styling is accomplished with CSS, Tailwind, or Styled-Components. Hosting is on GitHub Pages for the frontend, with a simple Node.js backend. Emphasis is placed on core features, with simplified grading, file handling, logging, and infrastructure.

---

## 2. Core Features

- Teachers create and administer classrooms and problem classes.
- Problems can be hand-authored or batch-generated by an LLM (Anthropic).
- Students submit code files, which are graded automatically against a test suite.
- Mastery is tracked per problem class, based on passing all test cases for a randomly assigned problem.
- Teachers and TAs have distinct roles and access levels.
- Basic logging and classroom-level settings enhance transparency and security.

---

## 3. Authentication & User Management

- **Authentication:** Simple username and password registration system.
  - Users create accounts using a chosen username and password.
  - Passwords are securely hashed and stored in the database.
  - Login and registration endpoints are provided.
  - Password reset functionality should be implemented (via email or security questions).
- **User Roles:**
  - **Teacher:** Creates/manages classrooms and content, configures LLM, views logs.
  - **Co-Teacher:** Same as TA.
  - **TA (Teaching Assistant):** Views student submission history and grading results only.
  - **Student:** Joins classrooms, submits code, views progression and grading results.
- **Role Assignment:**
  - Teachers create classrooms and receive admin rights.
  - Students self-signup using an access code.
  - Teachers assign students as TAs or co-teachers as needed.

---

## 4. Classroom Management & Settings

- **Classroom Creation:** By teachers only.
- **Access:** Students join via access code.
- **Settings (per classroom):**
  - Allowed file type(s) for all submissions (e.g., `.py`, `.java`).
  - Naming conventions for submissions (if desired).
  - Visibility settings for test cases/results.
  - Any other relevant classroom-specific rules or restrictions.
- **No artificial limits** on number of students per classroom.

---

## 5. Problem Classes & Problems

### 5.1 Problem Classes

- **Attributes:**
  - Title (unique)
  - Description (â‰¤200 words)
  - Difficulty
  - Learning objectives (required)
  - Grading criteria (required)
  - Prerequisites (optional, list of other problem classes)
  - Tags (optional)
  - Code templates (optional, e.g., starter code)
- **Limits:** Max 20 classes per teacher.

### 5.2 Problems

- **Attributes:**
  - Problem statement
  - Solution/explanation (visible only to teachers/TAs)
  - At least 10 test cases (required)
  - Starter code, hints, max attempts, deadline (optional)
- **Creation:**
  - Teachers can hand-author unlimited problems.
  - LLM batch generation (see below) is rate-limited.

---

## 6. Problem Generation (LLM Integration)

- **LLM:** Anthropic (Claude or similar), API configuration managed per teacher.
- **API Key Management:**
  - Teachers must provide own API key (encrypted in DB). No key = no LLM features.
- **Batch Generation:**
  - Teachers may generate up to 5 batches of 10 problems per problem class.
  - Teachers review, edit, and approve LLM-generated problems.
  - Teachers may hand-author additional problems beyond LLM batches.
- **Prompt Templates:** System provides creative default prompts; teachers may edit.
- **LLM-generated problems must be manually approved** before students can access.

---

## 7. Submission, Grading, and Mastery

### 7.1 Submission

- Students submit code files per assigned problem.
- File type restriction is enforced per classroom.
- Files are **processed for grading, then deleted; only test results are stored**.
- Submission history (test results, feedback, timestamps) is visible to students.

### 7.2 Grading

- **Automatic grading** via test suite (minimum 10 tests/problem).
- **Grade = % of tests passed** (e.g., 7/10 = 70%). Mastery = 100%.
- Teachers set visibility: full test suite, or only expected vs. actual output.
- Teachers/TAs can add written feedback to submissions.

### 7.3 Mastery & Progression

- Mastery is assigned at 100% (all tests passed) on the **most recent (active) problem** for a class.
- Once achieved, mastery cannot be revoked.
- Students may request a new problem if stuck; only the current active problem counts for mastery.
- Prerequisites restrict access to problem classes until mastered.

---

## 8. Grading Infrastructure & Job Status

- **Grading Execution:** Grading is performed synchronously or with a minimal background process handled within the Node.js server.
  - When a student submits a solution, the backend executes grading logic and returns the result in the same request/response cycle or as soon as possible.
  - If minimal background processing is needed, it should be implemented simply (e.g., using setTimeout or a basic in-memory queue), but extensive job queue systems are avoided.
- **Job Status:** No real-time or queued job status tracking is required. Students receive grading results without polling or monitoring a queue.

---

## 9. File Uploads & Security

- **Allowed File Types:** Configured per classroom; enforced server-side.
- **Upload Handling:** Files are stored in a local temporary directory on the server, processed for grading, and then deleted immediately after grading.
- **Only test results, feedback, and metadata are persisted.**
- **Security:** Files are validated for type/size and scanned for malware before grading, using simple local validation as feasible.

---

## 10. Logging

- The system maintains basic operational and debug logs:
  - Log significant system events such as logins, submissions, grading actions, problem/classroom creation, and errors.
  - Logs may be stored as simple text files or in a minimal database table.
  - Full audit trail immutability and access control is not required.
  - Logs are intended for troubleshooting and operational review, not compliance or regulatory purposes.

---

## 11. Additional Security & Compliance

- **API keys:** Encrypted at rest, never exposed in logs or UIs.
- **Role-based access control:** Strict enforcement; TAs/co-teachers cannot make admin changes.
- **Data privacy:** Submission code files purged after grading; only results retained.
- **Account management:** All users authenticated via username and password system.
- **Compliance:** Basic data security best practices are followed, but the system is not designed to meet full regulatory (FERPA/GDPR) requirements out of the box.

---

## 12. Frontend Requirements

- **UI for:**
  - Registration, login, and password reset.
  - Classroom creation/joining with access codes.
  - Problem class management and prerequisite mapping.
  - LLM config, batch generation, and approval workflow.
  - Submission upload with file type enforcement and grading result display.
  - Viewing submission histories and feedback.
  - Role management and basic log access for teachers.
- **Accessible and responsive design** for all user roles.
- **Styling:** Use CSS, Tailwind, or Styled-Components as appropriate.

---

## 13. Backend & Infrastructure

- **Frontend:** React (Vite), hosted on GitHub Pages.
- **Backend:** Node.js server (JavaScript/TypeScript, minimal endpoints, synchronous or minimally asynchronous processing).
- **Database:** MySQL (Amazon RDS).
- **File storage:** Local temporary storage on the backend server.
- **LLM Integration:** Anthropic API per-teacher, with encrypted key storage.
- **Authentication:** Username and password system.
- **Logging:** Basic log files or database tables.
- **Package management:** npm.

---

## 14. Extensibility & Future Considerations

- **LMS Integration:** (e.g., Canvas) can be added in the future.
- **Notification System:** (e.g., email, in-app) can be added in the future.
- **Support for additional languages and file types** via classroom settings.
- **Admin dashboard:** for basic system monitoring and user management.

---

**End of Specification**